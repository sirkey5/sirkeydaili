function FindProxyForURL(url, host) {
    const httpProxy = "PROXY 192.168.1.55:10808"; // HTTP代理
    const socksProxy = "SOCKS5 192.168.1.55:10808"; // SOCKS5代理
    const direct = "DIRECT"; // 直接连接

    // 更全面的中国域名后缀
    const chinaDomainSuffixes = [
        ".ac.cn", ".ah.cn", ".bj.cn", ".com.cn", ".edu.cn",
        ".gov.cn", ".gs.cn", ".gx.cn", ".ha.cn", ".hb.cn",
        ".he.cn", ".hi.cn", ".hk.cn", ".hn.cn", ".jl.cn",
        ".js.cn", ".jx.cn", ".ln.cn", ".mo.cn", ".net.cn",
        ".nm.cn", ".nx.cn", ".org.cn", ".qh.cn", ".sc.cn",
        ".sh.cn", ".sn.cn", ".tj.cn", ".tw.cn", ".tx.cn",
        ".xj.cn", ".xsbn.cn", ".xz.cn", ".yn.cn", ".za.cn",
        ".zj.cn", ".xn--fiqs8s" // 对应".中国"
    ];

    // 扩展的中国IP范围（IPv4）
    const chinaIPRanges = [
        // 中国主要IP段（覆盖更多范围）
        ["1.0.0.0", "255.0.0.0"],    // 1.0.0.0/8
        ["11.0.0.0", "255.0.0.0"],   // 11.0.0.0/8
        ["27.0.0.0", "255.0.0.0"],   // 27.0.0.0/8
        ["28.0.0.0", "255.0.0.0"],   // 28.0.0.0/8
        ["29.0.0.0", "255.0.0.0"],   // 29.0.0.0/8
        ["30.0.0.0", "255.0.0.0"],   // 30.0.0.0/8
        ["36.0.0.0", "255.0.0.0"],   // 36.0.0.0/8
        ["58.0.0.0", "255.0.0.0"],   // 58.0.0.0/8
        ["59.0.0.0", "255.0.0.0"],   // 59.0.0.0/8
        ["101.0.0.0", "255.0.0.0"],  // 101.0.0.0/8
        ["103.0.0.0", "255.0.0.0"],  // 103.0.0.0/8
        ["106.0.0.0", "255.0.0.0"],  // 106.0.0.0/8
        ["107.0.0.0", "255.0.0.0"],  // 107.0.0.0/8
        ["108.0.0.0", "255.0.0.0"],  // 108.0.0.0/8
        ["109.0.0.0", "255.0.0.0"],  // 109.0.0.0/8
        ["111.0.0.0", "255.0.0.0"],  // 111.0.0.0/8
        ["112.0.0.0", "255.0.0.0"],  // 112.0.0.0/8
        ["113.0.0.0", "255.0.0.0"],  // 113.0.0.0/8
        ["114.0.0.0", "255.0.0.0"],  // 114.0.0.0/8
        ["115.0.0.0", "255.0.0.0"],  // 115.0.0.0/8
        ["116.0.0.0", "255.0.0.0"],  // 116.0.0.0/8
        ["117.0.0.0", "255.0.0.0"],  // 117.0.0.0/8
        ["118.0.0.0", "255.0.0.0"],  // 118.0.0.0/8
        ["119.0.0.0", "255.0.0.0"],  // 119.0.0.0/8
        ["120.0.0.0", "255.0.0.0"],  // 120.0.0.0/8
        ["121.0.0.0", "255.0.0.0"],  // 121.0.0.0/8
        ["122.0.0.0", "255.0.0.0"],  // 122.0.0.0/8
        ["123.0.0.0", "255.0.0.0"],  // 123.0.0.0/8
        ["124.0.0.0", "255.0.0.0"],  // 124.0.0.0/8
        ["125.0.0.0", "255.0.0.0"],  // 125.0.0.0/8
        ["130.0.0.0", "255.0.0.0"],  // 130.0.0.0/8
        ["131.0.0.0", "255.0.0.0"],  // 131.0.0.0/8
        ["132.0.0.0", "255.0.0.0"],  // 132.0.0.0/8
        ["133.0.0.0", "255.0.0.0"],  // 133.0.0.0/8
        ["134.0.0.0", "255.0.0.0"],  // 134.0.0.0/8
        ["135.0.0.0", "255.0.0.0"],  // 135.0.0.0/8
        ["136.0.0.0", "255.0.0.0"],  // 136.0.0.0/8
        ["137.0.0.0", "255.0.0.0"],  // 137.0.0.0/8
        ["138.0.0.0", "255.0.0.0"],  // 138.0.0.0/8
        ["139.0.0.0", "255.0.0.0"],  // 139.0.0.0/8
        ["140.0.0.0", "255.0.0.0"],  // 140.0.0.0/8
        ["141.0.0.0", "255.0.0.0"],  // 141.0.0.0/8
        ["142.0.0.0", "255.0.0.0"],  // 142.0.0.0/8
        ["143.0.0.0", "255.0.0.0"],  // 143.0.0.0/8
        ["144.0.0.0", "255.0.0.0"],  // 144.0.0.0/8
        ["145.0.0.0", "255.0.0.0"],  // 145.0.0.0/8
        ["146.0.0.0", "255.0.0.0"],  // 146.0.0.0/8
        ["147.0.0.0", "255.0.0.0"],  // 147.0.0.0/8
        ["148.0.0.0", "255.0.0.0"],  // 148.0.0.0/8
        ["149.0.0.0", "255.0.0.0"],  // 149.0.0.0/8
        ["150.0.0.0", "255.0.0.0"],  // 150.0.0.0/8
        ["151.0.0.0", "255.0.0.0"],  // 151.0.0.0/8
        ["152.0.0.0", "255.0.0.0"],  // 152.0.0.0/8
        ["153.0.0.0", "255.0.0.0"],  // 153.0.0.0/8
        ["154.0.0.0", "255.0.0.0"],  // 154.0.0.0/8
        ["155.0.0.0", "255.0.0.0"],  // 155.0.0.0/8
        ["156.0.0.0", "255.0.0.0"],  // 156.0.0.0/8
        ["157.0.0.0", "255.0.0.0"],  // 157.0.0.0/8
        ["158.0.0.0", "255.0.0.0"],  // 158.0.0.0/8
        ["159.0.0.0", "255.0.0.0"],  // 159.0.0.0/8
        ["160.0.0.0", "255.0.0.0"],  // 160.0.0.0/8
        ["161.0.0.0", "255.0.0.0"],  // 161.0.0.0/8
        ["162.0.0.0", "255.0.0.0"],  // 162.0.0.0/8
        ["163.0.0.0", "255.0.0.0"],  // 163.0.0.0/8
        ["164.0.0.0", "255.0.0.0"],  // 164.0.0.0/8
        ["165.0.0.0", "255.0.0.0"],  // 165.0.0.0/8
        ["166.0.0.0", "255.0.0.0"],  // 166.0.0.0/8
        ["167.0.0.0", "255.0.0.0"],  // 167.0.0.0/8
        ["168.0.0.0", "255.0.0.0"],  // 168.0.0.0/8
        ["169.0.0.0", "255.0.0.0"],  // 169.0.0.0/8
        ["170.0.0.0", "255.0.0.0"],  // 170.0.0.0/8
        ["171.0.0.0", "255.0.0.0"],  // 171.0.0.0/8
        ["172.16.0.0", "255.240.0.0"], // 172.16.0.0/12
        ["173.0.0.0", "255.0.0.0"],  // 173.0.0.0/8
        ["174.0.0.0", "255.0.0.0"],  // 174.0.0.0/8
        ["175.0.0.0", "255.0.0.0"],  // 175.0.0.0/8
        ["176.0.0.0", "255.0.0.0"],  // 176.0.0.0/8
        ["177.0.0.0", "255.0.0.0"],  // 177.0.0.0/8
        ["178.0.0.0", "255.0.0.0"],  // 178.0.0.0/8
        ["179.0.0.0", "255.0.0.0"],  // 179.0.0.0/8
        ["180.0.0.0", "255.0.0.0"],  // 180.0.0.0/8
        ["181.0.0.0", "255.0.0.0"],  // 181.0.0.0/8
        ["182.0.0.0", "255.0.0.0"],  // 182.0.0.0/8
        ["183.0.0.0", "255.0.0.0"],  // 183.0.0.0/8
        ["184.0.0.0", "255.0.0.0"],  // 184.0.0.0/8
        ["185.0.0.0", "255.0.0.0"],  // 185.0.0.0/8
        ["186.0.0.0", "255.0.0.0"],  // 186.0.0.0/8
        ["187.0.0.0", "255.0.0.0"],  // 187.0.0.0/8
        ["188.0.0.0", "255.0.0.0"],  // 188.0.0.0/8
        ["189.0.0.0", "255.0.0.0"],  // 189.0.0.0/8
        ["190.0.0.0", "255.0.0.0"],  // 190.0.0.0/8
        ["191.0.0.0", "255.0.0.0"],  // 191.0.0.0/8
        ["192.0.0.0", "255.255.255.0"], // 192.168.1.0/24
        ["193.0.0.0", "255.0.0.0"],  // 193.0.0.0/8
        ["194.0.0.0", "255.0.0.0"],  // 194.0.0.0/8
        ["195.0.0.0", "255.0.0.0"],  // 195.0.0.0/8
        ["196.0.0.0", "255.0.0.0"],  // 196.0.0.0/8
        ["197.0.0.0", "255.0.0.0"],  // 197.0.0.0/8
        ["198.0.0.0", "255.0.0.0"],  // 198.0.0.0/8
        ["199.0.0.0", "255.0.0.0"],  // 199.0.0.0/8
        ["200.0.0.0", "255.0.0.0"],  // 200.0.0.0/8
        ["201.0.0.0", "255.0.0.0"],  // 201.0.0.0/8
        ["202.0.0.0", "255.0.0.0"],  // 202.0.0.0/8
        ["203.0.0.0", "255.0.0.0"],  // 203.0.0.0/8
        ["223.0.0.0", "255.255.255.0"] // 223.0.0.0/24
    ];

    // 检查是否为中国大陆域名
    function isChinaDomain(host) {
        return chinaDomainSuffixes.some(suffix => dnsDomainIs(host, suffix));
    }

    // 判断IP是否属于中国大陆范围（IPv4）
    function isChinaIP(ip) {
        if (!ip) return false;
        if (ip.indexOf(":") !== -1) {
            // 简化IPv6处理，暂时不处理
            return false;
        }
        return chinaIPRanges.some(range => isInNet(ip, range[0], range[1]));
    }

    // 主逻辑
    const resolvedIP = dnsResolve(host);
    const isChina = isChinaDomain(host) || isChinaIP(resolvedIP);

    // 国内外请求分流（统一使用SOCKS5代理）
    return isChina ? direct : socksProxy;
}
